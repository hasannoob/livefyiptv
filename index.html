<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Livefy IPTV Player - Advanced</title>

    <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet" />

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding-top: 570px; 
            background-color: #f4f4f4;
        }

        /* --- ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶π‡ßá‡¶°‡¶æ‡¶∞ ‡¶è‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
        #fixed-top-section {
            position: fixed;
            top: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100%;
            max-width: 900px;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5); /* ‡¶Ü‡¶∞‡ßã ‡¶Ü‡¶ï‡¶∞‡ßç‡¶∑‡¶£‡ßÄ‡¶Ø‡¶º ‡¶∂‡ßç‡¶Ø‡¶æ‡¶°‡ßã */
            border-radius: 8px;
            overflow: hidden; /* ‡¶≠‡ßá‡¶§‡¶∞‡ßá‡¶∞ ‡¶∏‡¶¨ ‡¶â‡¶™‡¶æ‡¶¶‡¶æ‡¶® ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞‡¶≠‡¶æ‡¶¨‡ßá ‡¶•‡¶æ‡¶ï‡¶¨‡ßá */
        }

        .player-header {
            background-color: #dc3545; /* ‡¶™‡ßç‡¶∞‡¶ø‡¶Æ‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ ‡¶≤‡¶æ‡¶≤ ‡¶∞‡¶Ç */
            color: white;
            padding: 10px 20px;
            text-align: center;
            font-size: 24px;
            font-weight: bold;
            letter-spacing: 1px;
        }
        
        #video-container {
            background-color: #000;
            height: 480px; 
            position: relative; /* ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶ì‡¶Ø‡¶º‡¶æ‡¶ü‡¶æ‡¶∞‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï ‡¶è‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø */
        }

        /* Video.js ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡¶ï‡ßá ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶ï‡¶∞‡¶æ */
        .video-js {
            width: 100%;
            height: 100%;
            border-radius: 0 0 0 0; 
        }

        /* --- ‡¶∞‡ßá‡¶ú‡ßã‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç ‡¶¨‡¶æ‡¶ü‡¶® ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
        .resolution-settings {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
        }

        .resolution-button {
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
            border: none;
            padding: 5px 10px;
            cursor: pointer;
            border-radius: 4px;
            font-size: 14px;
            margin-left: 5px;
            transition: background-color 0.3s;
        }

        .resolution-button:hover {
            background-color: rgba(0, 0, 0, 0.9);
        }

        /* --- ‡¶ï‡¶æ‡¶∏‡ßç‡¶ü‡¶Æ ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶ì‡¶Ø‡¶º‡¶æ‡¶ü‡¶æ‡¶∞‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ --- */
        #custom-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            font-size: 30px;
            font-weight: bold;
            opacity: 1;
            transition: opacity 0.5s;
            z-index: 99; 
            pointer-events: none; /* ‡¶Ø‡¶æ‡¶§‡ßá ‡¶™‡ßç‡¶≤‡ßá‡ßü‡¶æ‡¶∞‡ßá‡¶∞ ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï‡ßá ‡¶¨‡¶æ‡¶ß‡¶æ ‡¶®‡¶æ ‡¶¶‡ßá‡ßü */
        }
        
        .loading-text {
            font-size: 16px;
            margin-top: 10px;
            color: #ccc;
        }

        .spinner {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #dc3545;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .hidden-overlay {
            opacity: 0 !important;
        }


        /* --- ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á) --- */
        .scrolling-header {
            background-color: #333;
            color: white;
            padding: 5px 0;
            overflow: hidden; 
            white-space: nowrap;
        }

        .marquee-text {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 15s linear infinite;
        }

        @keyframes marquee {
            0%   { transform: translate(0, 0); }
            100% { transform: translate(-100%, 0); }
        }

        .channel-list-container {
            max-width: 900px;
            margin: 20px auto; 
            padding: 20px;
            background-color: white;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        #channel-list {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            max-height: 500px; 
            overflow-y: auto;
            padding-right: 15px;
        }

        .channel-item {
            background-color: #007bff;
            color: white;
            padding: 10px;
            text-align: center;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .channel-item:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>

    <div id="fixed-top-section">
        <div class="player-header">
            üì∫ Livefy IPTV
        </div>
        
        <div id="video-container">
            <div id="custom-overlay">
                <div class="spinner"></div>
                <div class="loading-text" id="overlay-text">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</div>
            </div>
            
            <video
                id="my-video"
                class="video-js vjs-big-play-centered"
                controls
                preload="auto"
                poster="[attachment_0](attachment)"
                data-setup="{}"
            >
                <p class="vjs-no-js">
                    ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
                </p>
            </video>

            <div class="resolution-settings">
                <button class="resolution-button" title="Video Quality">‚öôÔ∏è Quality</button>
            </div>
        </div>

        <div class="scrolling-header">
            <div class="marquee-text">
                **‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!** ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤‡¶ø‡¶Ç ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡¶æ‡¶∞‡•§ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶§‡¶•‡ßç‡¶Ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶ï‡¶∞‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶¨‡ßá‡•§
            </div>
        </div>
    </div>
    
    <div class="channel-list-container">
        <h3>‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ (‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤‡ßá‡¶¨‡¶≤)</h3>
        <ul id="channel-list">
            <li>M3U ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</li>
        </ul>
    </div>

    <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-hls/5.15.0/videojs-contrib-hls.js"></script>
    <script>
        // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ M3U ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü‡ßá‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï
        const M3U_URL = 'https://raw.githubusercontent.com/hasannoob/Tofee-Playlist/refs/heads/main/Toffee_Livefy_tv.m3u'; // <-- ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶∏‡¶≤ ‡¶≤‡¶ø‡¶Ç‡¶ï ‡¶¶‡¶ø‡¶®

        // Video.js ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶á‡¶®‡¶ø‡¶∂‡¶ø‡ßü‡¶æ‡¶≤‡¶æ‡¶á‡¶ú ‡¶ï‡¶∞‡ßÅ‡¶®
        const player = videojs('my-video');
        const channelList = document.getElementById('channel-list');
        const overlay = document.getElementById('custom-overlay');
        const overlayText = document.getElementById('overlay-text');
        
        // ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶á‡¶≠‡ßá‡¶®‡ßç‡¶ü ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶≤‡¶æ‡¶∞
        player.on('waiting', () => {
            // ‡¶¨‡¶æ‡¶´‡¶æ‡¶∞‡¶ø‡¶Ç ‡¶¨‡¶æ ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶π‡¶≤‡ßá
            overlay.classList.remove('hidden-overlay');
            overlayText.innerHTML = '‡¶≤‡ßã‡¶°‡¶ø‡¶Ç... <br> (‡¶¨‡¶æ‡¶´‡¶æ‡¶∞‡¶ø‡¶Ç)';
        });

        player.on('playing', () => {
            // ‡¶™‡ßç‡¶≤‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡¶≤‡ßá ‡¶¨‡¶æ ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶∂‡ßá‡¶∑ ‡¶π‡¶≤‡ßá
            overlay.classList.add('hidden-overlay');
            overlayText.innerHTML = 'Livefy IPTV';
        });

        player.on('loadeddata', () => {
             // ‡¶°‡ßá‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶™‡¶∞‡ßá
             overlay.classList.add('hidden-overlay');
             overlayText.innerHTML = 'Livefy IPTV';
        });

        /**
         * M3U ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶æ‡¶∞‡ßç‡¶∏ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
         */
        function parseM3U(data) {
            const lines = data.split('\n');
            const channels = [];
            let currentChannel = {};

            for (const line of lines) {
                if (line.startsWith('#EXTINF:')) {
                    const nameMatch = line.match(/,(.*)/);
                    if (nameMatch && nameMatch[1]) {
                        currentChannel.name = nameMatch[1].trim();
                    }
                } else if (line.startsWith('http')) {
                    currentChannel.url = line.trim();
                    // M3U8 ‡¶´‡¶∞‡¶Æ‡ßç‡¶Ø‡¶æ‡¶ü ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ (HLS)
                    currentChannel.type = (currentChannel.url.includes('.m3u8')) ? 'application/x-mpegURL' : 'video/mp4'; 
                    
                    if (currentChannel.name && currentChannel.url) {
                        channels.push(currentChannel);
                    }
                    currentChannel = {};
                }
            }
            return channels;
        }

        /**
         * ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞‡ßá‡¶∞ ‡¶∏‡ßã‡¶∞‡ßç‡¶∏ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
         */
        function playChannel(url, name, type) {
            // ‡¶≤‡ßã‡¶°‡¶ø‡¶Ç ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ
            document.getElementById('overlay-text').innerHTML = '‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...';
            overlay.classList.remove('hidden-overlay');

            player.pause(); // ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡¶ø‡¶§ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶ú ‡¶ï‡¶∞‡¶æ
            player.src({
                src: url,
                type: type 
            });
            player.load();
            player.play().catch(error => {
                console.error("‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:", error);
            });
            document.title = `${name} - Livefy IPTV`;
        }
        
        /**
         * ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶∞‡ßá‡¶®‡ßç‡¶°‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®
         */
        function renderChannelList(channels) {
            channelList.innerHTML = ''; 
            if (channels.length === 0) {
                channelList.innerHTML = '<li>‡¶ï‡ßã‡¶®‡ßã ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</li>';
                return;
            }

            channels.forEach(channel => {
                const listItem = document.createElement('li');
                listItem.className = 'channel-item';
                listItem.textContent = channel.name;

                listItem.addEventListener('click', () => {
                    playChannel(channel.url, channel.name, channel.type);
                });

                channelList.appendChild(listItem);
            });
            
            // ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡¶ü‡¶ø ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶æ
            if (channels.length > 0) {
                playChannel(channels[0].url, channels[0].name, channels[0].type);
            }
        }


        // M3U ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
        fetch(M3U_URL)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ${response.status}. ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§`);
                }
                return response.text();
            })
            .then(data => {
                const channels = parseM3U(data);
                renderChannelList(channels);
            })
            .catch(error => {
                console.error("M3U ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø:", error);
                channelList.innerHTML = `<li><span style="color: red;">‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø:</span> M3U ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ CORS ‡¶¨‡¶æ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li>`;
                document.getElementById('overlay-text').innerHTML = '‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§';
            });
            
        // Video.js-‡¶è‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶∞‡ßá‡¶ú‡ßã‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶®
        // HLS (M3U8) ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Æ ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶≤‡ßá Video.js ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤‡ßá
        // ‡¶∞‡ßá‡¶ú‡ßã‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç ‡¶¨‡¶æ‡¶ü‡¶® ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßá ‡¶¶‡ßá‡ßü‡•§ ‡¶§‡¶æ‡¶á ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶ï‡ßã‡¶° ‡¶¶‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶®‡ßá‡¶á‡•§
        document.querySelector('.resolution-button').addEventListener('click', function() {
            alert('Video.js ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶∞‡ßá‡¶ú‡ßã‡¶≤‡¶ø‡¶â‡¶∂‡¶® ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡ßá‡¶≤ ‡¶ï‡¶∞‡ßá‡•§ HLS (M3U8) ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡¶ø‡¶Æ‡ßá ‡¶è‡¶ü‡¶ø ‡¶ï‡ßã‡ßü‡¶æ‡¶≤‡¶ø‡¶ü‡¶ø ‡¶∏‡ßá‡¶ü‡¶ø‡¶Ç ‡¶™‡ßç‡¶≤‡ßá‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶ï‡¶®‡ßç‡¶ü‡ßç‡¶∞‡ßã‡¶≤‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá‡•§');
        });

    </script>
</body>
</html>
