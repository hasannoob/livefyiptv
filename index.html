<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Livefy IPTV Player - Final Channel Name Fix</title>

    <link href="https://vjs.zencdn.net/8.6.1/video-js.css" rel="stylesheet" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
        /* [‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§] */
        body { font-family: Arial, sans-serif; margin: 0; padding-top: 0; background-color: #f4f4f4; }
        #fixed-top-section { position: fixed; top: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 450px; height: 100vh; z-index: 1000; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.5); border-radius: 0; overflow: hidden; }
        .player-header { background-color: #dc3545; color: white; padding: 10px 20px; text-align: center; font-size: 24px; font-weight: bold; letter-spacing: 1px; border-radius: 0; }
        #video-container { background-color: #000; height: 250px; position: relative; }
        .scrolling-header { background-color: #333; color: white; padding: 5px 0; overflow: hidden; white-space: nowrap; }
        .channel-list-container { width: 100%; height: calc(100vh - 250px - 44px - 30px); padding: 20px; background-color: white; box-sizing: border-box; display: flex; flex-direction: column; }
        .search-label, #search-box, #channel-info-bar { flex-shrink: 0; }
        #channel-list {
            list-style: none;
            padding: 0;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 10px;
            overflow-y: auto; 
            padding-right: 15px;
            flex-grow: 1; 
            margin-top: 10px;
        }

        /* ******************************************** */
        /* ‚úÖ ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶®‡¶æ‡¶Æ‡ßá‡¶∞ ‡¶´‡¶ø‡¶ï‡ßç‡¶∏‡¶° ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤: ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡ß® ‡¶≤‡¶æ‡¶á‡¶® */
        /* ******************************************** */
        .channel-item {
            background-color: #007bff;
            color: white;
            padding: 10px 10px; 
            text-align: center;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
            
            /* ‡¶®‡¶æ‡¶Æ‡¶ó‡ßÅ‡¶≤‡ßã‡¶ï‡ßá ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶â‡¶ö‡ßç‡¶ö‡¶§‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∏‡ßÄ‡¶Æ‡¶æ‡¶¨‡¶¶‡ßç‡¶ß ‡¶∞‡¶æ‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø */
            overflow: hidden;
            
            /* ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶≤‡¶æ‡¶á‡¶® ‡¶ü‡ßç‡¶∞‡¶æ‡¶ô‡ßç‡¶ï‡ßá‡¶∂‡¶® ‡¶™‡ßç‡¶∞‡¶™‡¶æ‡¶∞‡ßç‡¶ü‡¶ø */
            display: -webkit-box;
            -webkit-line-clamp: 2; /* **‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü‡¶ï‡ßá ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö 2 ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶∏‡ßÄ‡¶Æ‡¶æ‡¶¨‡¶¶‡ßç‡¶ß ‡¶ï‡¶∞‡¶¨‡ßá** */
            -webkit-box-orient: vertical;
            
            /* ‡¶≤‡¶æ‡¶á‡¶® ‡¶â‡¶ö‡ßç‡¶ö‡¶§‡¶æ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã, ‡¶Ø‡¶æ ‡¶Æ‡¶æ‡¶≤‡ßç‡¶ü‡¶ø-‡¶≤‡¶æ‡¶á‡¶® ‡¶ü‡ßç‡¶∞‡¶æ‡¶ô‡ßç‡¶ï‡ßá‡¶∂‡¶®‡¶ï‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡ßá */
            line-height: 1.25em; 
            
            /* ‡¶∏‡¶∞‡ßç‡¶¨‡ßã‡¶ö‡ßç‡¶ö ‡¶â‡¶ö‡ßç‡¶ö‡¶§‡¶æ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ: (1.25em x 2 ‡¶≤‡¶æ‡¶á‡¶®) */
            max-height: 2.5em; 
            
            /* ‡¶Ö‡¶§‡¶ø‡¶∞‡¶ø‡¶ï‡ßç‡¶§ ‡¶≤‡¶æ‡¶á‡¶® ‡¶ï‡ßá‡¶ü‡ßá ‡¶Ø‡¶æ‡¶ï */
            text-overflow: ellipsis; 
            white-space: normal; /* ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü‡¶ï‡ßá ‡¶™‡¶∞‡ßá‡¶∞ ‡¶≤‡¶æ‡¶á‡¶®‡ßá ‡¶Ø‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶∞ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶§‡¶ø ‡¶¶‡ßá‡¶Ø‡¶º */
        }

        .channel-item:hover {
            background-color: #0056b3;
        }
        /* ******************************************** */
        /* [‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶∏‡ßç‡¶ü‡¶æ‡¶á‡¶≤ ‡¶Ö‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶ø‡¶§] */
        .video-js { width: 100%; height: 100%; border-radius: 0; }
        #custom-overlay { position: absolute; top: 5px; right: 5px; width: auto; height: auto; background-color: rgba(0, 0, 0, 0.7); color: white; padding: 8px 12px; border-radius: 5px; display: flex; justify-content: center; align-items: center; flex-direction: row; font-size: 14px; font-weight: bold; opacity: 1; transition: opacity 0.5s; z-index: 99; pointer-events: none; }
        .spinner { border: 3px solid #f3f3f3; border-top: 3px solid #dc3545; border-radius: 50%; width: 15px; height: 15px; animation: spin 1s linear infinite; }
        .hidden-overlay { opacity: 0 !important; }
        .marquee-text { display: inline-block; padding-left: 100%; animation: marquee 15s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        @keyframes marquee { 0% { transform: translate(0, 0); } 100% { transform: translate(-100%, 0); } }
        .search-label { display: block; margin-bottom: 5px; font-weight: bold; color: #333; }
        #search-box { width: 100%; padding: 10px; margin-bottom: 10px; border: 1px solid #ccc; border-radius: 5px; box-sizing: border-box; font-size: 16px; }
        #channel-info-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 10px; background-color: #e9ecef; border-radius: 5px; font-size: 15px; }
        #telegram-btn { background-color: #0088cc; color: white; padding: 8px 15px; border-radius: 5px; text-decoration: none; font-weight: bold; display: flex; align-items: center; line-height: 1; }
        #telegram-btn i { margin-right: 5px; }
        #channel-count-display { color: #dc3545; font-weight: bold; }
    </style>
</head>
<body>

    <div id="fixed-top-section">
        <div class="player-header">
            üì∫ Livefy IPTV
        </div>
        
        <div id="video-container">
            <div id="custom-overlay">
                <div class="spinner"></div>
                <div class="loading-text" id="overlay-text">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</div>
            </div>
            
            <video
                id="my-video"
                class="video-js vjs-big-play-centered"
                controls
                preload="auto"
                poster="https://i.ibb.co/L50n92S/Live-TV-Streaming-Icon.png" 
                data-setup="{}"
            >
                <p class="vjs-no-js">
                    ‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶∏‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
                </p>
            </video>
        </div>

        <div class="scrolling-header">
            <div class="marquee-text">
                **‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!** ‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤‡¶ø‡¶Ç ‡¶®‡ßã‡¶ü‡¶ø‡¶∂ ‡¶¨‡¶æ‡¶∞‡•§ ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶ó‡ßÅ‡¶∞‡ßÅ‡¶§‡ßç‡¶¨‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶§‡¶•‡ßç‡¶Ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶ï‡¶∞‡¶æ‡¶®‡ßã ‡¶Ø‡¶æ‡¶¨‡ßá‡•§
            </div>
        </div>
        
        <div class="channel-list-container">
            <h3>‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h3>
            
            <label for="search-box" class="search-label">üîç ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶ñ‡ßÅ‡¶Å‡¶ú‡ßÅ‡¶®</label>
            <input type="text" id="search-box" placeholder="‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..." onkeyup="filterChannels()">
            
            <div id="channel-info-bar">
                <span id="channel-count-display">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>
                <a href="YOUR_TELEGRAM_CHANNEL_LINK" target="_blank" id="telegram-btn">
                    <i class="fab fa-telegram-plane"></i> JOIN NOW
                </a>
            </div>
            
            <ul id="channel-list">
                <li>M3U ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</li>
            </ul>
        </div>
    </div>
    
    <script src="https://vjs.zencdn.net/8.6.1/video.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/videojs-contrib-hls/5.15.0/videojs-contrib-hls.js"></script>
    
    <script>
        const M3U_URL = 'https://raw.githubusercontent.com/hasannoob/Tofee-Playlist/refs/heads/main/Toffee_Livefy_tv.m3u'; 
        const TELEGRAM_LINK = 'https://t.me/livefytv'; 

        const player = videojs('my-video');
        const channelList = document.getElementById('channel-list');
        const overlay = document.getElementById('custom-overlay');
        const telegramBtn = document.getElementById('telegram-btn');
        const countDisplay = document.getElementById('channel-count-display');
        
        let allChannels = []; 
        
        telegramBtn.href = TELEGRAM_LINK;

        player.on('waiting', () => {
            overlay.classList.remove('hidden-overlay');
            overlay.innerHTML = '<div class="spinner"></div><div class="loading-text">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</div>';
        });

        player.on('playing', () => {
            overlay.classList.remove('hidden-overlay');
            overlay.innerHTML = '<div class="loading-text" style="margin:0; color: #fff;">LIVEFY IPTV</div>'; 
        });

        player.on('pause', () => {
            overlay.classList.add('hidden-overlay');
        });
        
        function cleanUpPlayer() {
            if (player) {
                player.src({ src: '', type: 'video/mp4' }); 
                player.poster('');
                player.load();
            }
        }

        function parseM3U(data) {
            const lines = data.split('\n');
            const channels = [];
            let currentChannel = {};

            for (const line of lines) {
                if (line.startsWith('#EXTINF:')) {
                    const nameMatch = line.match(/,(.*)/);
                    if (nameMatch && nameMatch[1]) {
                        currentChannel.name = nameMatch[1].trim();
                    }
                } else if (line.startsWith('http')) {
                    currentChannel.url = line.trim();
                    currentChannel.type = (currentChannel.url.includes('.m3u8')) ? 'application/x-mpegURL' : 'video/mp4'; 
                    
                    if (currentChannel.name && currentChannel.url) {
                        channels.push(currentChannel);
                    }
                    currentChannel = {};
                }
            }
            return channels;
        }

        function playChannel(url, name, type) {
            cleanUpPlayer(); 

            overlay.classList.remove('hidden-overlay');
            overlay.innerHTML = '<div class="spinner"></div><div class="loading-text">‡¶≤‡ßã‡¶°‡¶ø‡¶Ç...</div>';

            player.pause();
            player.src({
                src: url,
                type: type 
            });
            player.load();
            player.play().catch(error => {
                console.error("‡¶≠‡¶ø‡¶°‡¶ø‡¶ì ‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•:", error);
                overlay.innerHTML = '<div class="loading-text" style="margin:0; color: yellow;">‡¶™‡ßç‡¶≤‡ßá ‡¶ï‡¶∞‡¶§‡ßá ‡¶¨‡ßç‡¶Ø‡¶∞‡ßç‡¶•</div>';
            });
            document.title = `${name} - Livefy IPTV`;
        }
        
        function renderChannelList(channels) {
            channelList.innerHTML = ''; 
            
            countDisplay.textContent = `‡¶Æ‡ßã‡¶ü ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤: ${allChannels.length} ‡¶ü‡¶ø`; 

            if (channels.length === 0) {
                channelList.innerHTML = '<li>‡¶ï‡ßã‡¶®‡ßã ‡¶ö‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§</li>';
                return;
            }

            channels.forEach(channel => {
                const listItem = document.createElement('li');
                listItem.className = 'channel-item';
                listItem.textContent = channel.name;
                
                // **** ‡¶è‡¶á ‡¶≤‡¶æ‡¶á‡¶®‡¶ü‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ****
                // ‡¶Æ‡¶æ‡¶â‡¶∏ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ó‡ßá‡¶≤‡ßá ‡¶∏‡¶Æ‡ßç‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶®‡¶æ‡¶Æ ‡¶¶‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø title ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ü‡ßç‡¶∞‡¶ø‡¶¨‡¶ø‡¶â‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶π‡¶≤‡ßã
                listItem.title = channel.name; 
                // **********************************

                listItem.addEventListener('click', () => {
                    playChannel(channel.url, channel.name, channel.type);
                });

                channelList.appendChild(listItem);
            });
        }
        
        window.filterChannels = function() {
            const searchTerm = document.getElementById('search-box').value.toLowerCase();
            
            const filteredChannels = allChannels.filter(channel => 
                channel.name.toLowerCase().includes(searchTerm)
            );
            
            renderChannelList(filteredChannels);
        }

        fetch(M3U_URL)
            .then(response => {
                if (!response.ok) {
                    throw new Error(`HTTP ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø: ${response.status}. ‡¶´‡¶æ‡¶á‡¶≤ ‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§`);
                }
                return response.text();
            })
            .then(data => {
                allChannels = parseM3U(data); 
                renderChannelList(allChannels); 
                
                if (allChannels.length > 0) {
                    playChannel(allChannels[0].url, allChannels[0].name, allChannels[0].type);
                }
            })
            .catch(error => {
                console.error("M3U ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø:", error);
                channelList.innerHTML = `<li><span style="color: red;">‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø:</span> M3U ‡¶™‡ßç‡¶≤‡ßá‡¶≤‡¶ø‡¶∏‡ßç‡¶ü ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§ CORS ‡¶¨‡¶æ ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</li>`;
                overlay.innerHTML = '<div class="loading-text" style="margin:0; color: red;">‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§</div>';
                countDisplay.textContent = '‡¶≤‡ßã‡¶° ‡¶π‡¶Ø‡¶º‡¶®‡¶ø';
            });
    </script>
</body>
</html>
